# 数据库

[TOC]

### 三层模式两层映射

- 外模式(视图)用户级数据库
- 概念模式(表)概念级数据库
- 内模式(文件)物理级数据库

外模式到概念模式映射（保证数据逻辑稳定性），概念模式和内模式映射（保证数据物理稳定性）。

**数据库设计过程：** 需求分析（数据流图），概念结构分析（ER模型），逻辑结构分析（关系模式，表），物理模式（存储方式）。

**数据模式三要素：** 数据结构，数据操作，完整性约束。

### 数据流图

概念：以图形方式描述数据在系统中的流动和处理的过程。

**数据字典：** 定义数据流图中的各个成分。
**判定表/判定树：** 对加工处理的描述。

### 概念模型（ER图）

实体：具有相同属性的集合

属性：简单属性（不可细分），复合属性（可细分），单值属性和多值属性（一个属性对应值个数），Null，派生属性（通过其他属性得知的属性）。

联系：1对1(1:1),1对n(1:n或者1:*),多对多(n:m)

### 关系模型

- 规范化理论

1. 主键:该属性组可以唯一标识到一条记录，该属性组就是主键，主键是唯一的(实体完整性)，逐件取值唯一不允许为空。
2. 复合键：多个字段组合起来作为一个索引，一般用于复合主键。
3. 外键：用于和另一张表进行连接，比如A表的一个键是B表的主键，所以该键为A表的外键。

- ER图转关系模式

1. 通用可以一个实体转一个表，实体与实体之间的关系转一个表。
2. 1：1的关系模式时可以将关系归并到其中一个表中。
3. 1：n的关系模式时可以将关系归并到n端的表中。
4. n:m的关系模式时必须将关系单独转一个表。

### 关系运算

- 并，交，差

1. 并：将两张表合并，重复的去除。
2. 交：将两张表取相同的部分生成新表。
3. 差：A-B表示在A表中去除B表中也有的，然后生成新表，B-A表示在B表中去除A表也有的，然后生成新表。

- 笛卡尔积，投影和选择

1. 笛卡尔积：运算符为`×`,两张表的列相加,并且表1的每行和表二的每行分别连接。
2. 投影：运算符为Π~所需要的列~（表名）,然后选择需要的列生成新表，重复的去除。
3. 选择：选择运算符为 $\sigma_行(表名)$ 在对应的表中选择 $\sigma$ 里面符合条件的行，生成新表。

- 自然连接：两表自然连接，首先找到相同的列，然后在相同的列中找到相同的行，将两表中所有的列结合，然后去重，最后生成新表。
